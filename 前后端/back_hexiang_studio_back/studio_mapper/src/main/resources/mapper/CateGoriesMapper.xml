<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.back_hexiang_studio.mapper.CateGoriesMapper">
    <resultMap id="categoriesMap" type="com.back_hexiang_studio.dv.vo.material.categoriesVo">
        <id column="id" property="id"/>
        <result column="name" property="name"/>
        <result column="order_id" property="orderId"/>
    </resultMap>
    <resultMap id="materialMap" type="com.back_hexiang_studio.dv.vo.material.materialDetailVo">
        <id column="id" property="id"/>
        <result column="file_name" property="fileName"/>
        <result column="file_type" property="fileType"/>
        <result column="file_size" property="fileSize"/>
        <result column="url" property="url"/>
        <result column="description" property="description"/>
        <result column="category_id" property="categoryId"/>
        <result column="name" property="category"/>
        <result column="upload_time" property="uploadTime"/>
        <result column="uploader_id" property="uploaderId"/>
        <result column="uploader" property="uploader"/>
        <result column="download_count" property="downloadCount"/>
        <result column="is_public" property="isPublic"/>
    </resultMap>

    <!--添加分类-->
    <insert id="addCategory">
        insert into material_category (name,order_id,create_time,update_time,create_user,update_user) values(#{name},#{orderId},#{createTime},#{updateTime},#{createUser},#{updateUser} )
    </insert>

    <!--修改分类-->
    <update id="updateCategory">
        update material_category set name=#{name},order_id=#{orderId},update_time=#{updateTime},update_user=#{updateUser} where id=#{id}
    </update>

    <!--删除分类-->
    <delete id="deleteCategory">
        delete from material_category where id=#{id}
    </delete>
    <!--根据分类中的资料-->
    <delete id="deleteCategoryBymaterial">
        DELETE from material where category_id=#{id}
    </delete>
    <select id="getCategories" resultMap="categoriesMap">
        SELECT id,order_id,name FROM material_category
    </select>
    <!--根据名称查询分类-->
    <select id="countByName" resultType="java.lang.Integer">
    SELECT COUNT(1) FROM material_category WHERE name = #{name}
        </select>
    
    <select id="getCategoryNameById" resultType="java.lang.String">
        SELECT name FROM material_category WHERE id = #{categoryId}
    </select>
</mapper>

